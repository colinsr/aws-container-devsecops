<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.87.0" />
    <meta name="description" content="AWS Container DevSecOps Workshop">
<meta name="author" content="James Strong">

    <link rel="shortcut icon" href="/images/container-green.png" type="image/x-icon" />

    <title>Container Pipeline Exercise :: AWS Container DevSecOps</title>

    
    <link href="/css/nucleus.css?1632003396" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1632003396" rel="stylesheet">
    <link href="/css/hybrid.css?1632003396" rel="stylesheet">
    <link href="/css/featherlight.min.css?1632003396" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1632003396" rel="stylesheet">
    <link href="/css/auto-complete.css?1632003396" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1632003396" rel="stylesheet">
    <link href="/css/theme.css?1632003396" rel="stylesheet">
    <link href="/css/tabs.css?1632003396" rel="stylesheet">
    <link href="/css/hugo-theme.css?1632003396" rel="stylesheet">
    
    <link href="/css/theme-green.css?1632003396" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1632003396"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="/pipeline/exercise/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='"/") }}'>
  <img src="/images/container-green.png"></a>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1632003396"></script>
<script type="text/javascript" src="/js/auto-complete.js?1632003396"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/localhost:1313\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1632003396"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/intro/" title="Introduction" class="dd-item
        
        
        
        ">
      <a href="/intro/">
          Introduction
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/intro/presenter/" title="Presenter" class="dd-item ">
        <a href="/intro/presenter/">
        Presenter
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/intro/contino/" title="Contino" class="dd-item ">
        <a href="/intro/contino/">
        Contino
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/setup/" title="Workshop Setup" class="dd-item
        
        
        
        ">
      <a href="/setup/">
          Workshop Setup
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/setup/cloud9/" title="AWS Cloud9" class="dd-item ">
        <a href="/setup/cloud9/">
        AWS Cloud9
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/setup/iam/" title="Cloud 9 Settings Configuration" class="dd-item ">
        <a href="/setup/iam/">
        Cloud 9 Settings Configuration
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/setup/tools/" title="Workshop tools" class="dd-item ">
        <a href="/setup/tools/">
        Workshop tools
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/development/" title="Development Environment" class="dd-item
        
        
        
        ">
      <a href="/development/">
          Development Environment
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/development/signing/" title="Code Signing" class="dd-item ">
        <a href="/development/signing/">
        Code Signing
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/linting/" title="Linting" class="dd-item ">
        <a href="/development/linting/">
        Linting
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/owasp/" title="Open Web Application Security Project" class="dd-item ">
        <a href="/development/owasp/">
        Open Web Application Security Project
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/pre-commit/" title="Pre Commit" class="dd-item ">
        <a href="/development/pre-commit/">
        Pre Commit
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/development/3-musketeers/" title="3 Musketeers" class="dd-item ">
        <a href="/development/3-musketeers/">
        3 Musketeers
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/build/" title="Container Builds" class="dd-item
        
        
        
        ">
      <a href="/build/">
          Container Builds
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/build/container/" title="Secure Containers" class="dd-item ">
        <a href="/build/container/">
        Secure Containers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/build/exercise/" title="Secure Containers Exercise" class="dd-item ">
        <a href="/build/exercise/">
        Secure Containers Exercise
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/pipeline/" title="Container Pipeline" class="dd-item
        parent
        
        
        ">
      <a href="/pipeline/">
          Container Pipeline
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/pipeline/intro_exercise/" title="Container Pipeline Exercise Overview" class="dd-item ">
        <a href="/pipeline/intro_exercise/">
        Container Pipeline Exercise Overview
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/pipeline/exercise/" title="Container Pipeline Exercise" class="dd-item active">
        <a href="/pipeline/exercise/">
        Container Pipeline Exercise
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/run/" title="Running Containers" class="dd-item
        
        
        
        ">
      <a href="/run/">
          Running Containers
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/run/exercise/" title="Running Containers Exercise" class="dd-item ">
        <a href="/run/exercise/">
        Running Containers Exercise
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/run/run.files/falco-demo/nodejs-bad-rest-api/readme/" title="" class="dd-item ">
        <a href="/run/run.files/falco-demo/nodejs-bad-rest-api/readme/">
        
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/conclusion/" title="Conclusion" class="dd-item
        
        
        
        ">
      <a href="/conclusion/">
          Conclusion
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/conclusion/clean/" title="Cleanup" class="dd-item ">
        <a href="/conclusion/clean/">
        Cleanup
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/conclusion/workshops/" title="Additional workshops" class="dd-item ">
        <a href="/conclusion/workshops/">
        Additional workshops
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/survey/" title="Survey" class="dd-item
        
        
        
        ">
      <a href="/survey/">
          Survey
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/strongjz/aws-container-devsecops"><i class='fab fa-github'></i> AWS Container DevsecOps Github repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://acloud.guru/overview/advanced-networking-with-kubernetes-for-aws"><i class='fab fa-clouds'></i> Advanced Networking with Kubernetes on AWS</a>
              </li>
          
              <li>
                  <a class="padding" href="https://learning.oreilly.com/library/view/networking-and-kubernetes/9781492081647/"><i class='fas fa-book'></i> Networking and Kubernetes: A Layered Appoarch</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/strongjz/aws-container-devsecopspipeline/exercise.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>AWS DevSecOps Container Pipeline</a> > <a href='/pipeline/'>Container Pipeline</a> > Container Pipeline Exercise
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#first-create-the-state-file-s3-bucket">First Create the state file s3 bucket</a></li>
    <li><a href="#initialize-the-terraform">Initialize the Terraform</a></li>
    <li><a href="#terraform-plan">Terraform Plan</a></li>
    <li><a href="#terraform-apply">Terraform Apply</a></li>
    <li><a href="#heading"></a></li>
    <li><a href="#aws-ecr">AWS ECR</a>
      <ul>
        <li><a href="#ecr-scans-our-images-for-vulnerabilities">ECR scans our images for vulnerabilities</a></li>
        <li><a href="#lets-reduce-our-image-size">Let&rsquo;s reduce our image size</a></li>
      </ul>
    </li>
    <li><a href="#aws-codepipeline">AWS CodePipeline</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Container Pipeline Exercise
            </h1>
          

        


<h2 id="first-create-the-state-file-s3-bucket">First Create the state file s3 bucket</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">aws s3 mb s3://devsecops-james-strong --region us-west-2
make_bucket: devsecops-james-strong
</code></pre></div><p>Inside our Terraform Directory in the devsecops repo</p>
<p>Update the <code>devsecopspipeline/terraform/config.tf</code> with the bucket name to store terraform state</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-hcl" data-lang="hcl"><span style="color:#66d9ef">terraform</span> {
    <span style="color:#66d9ef">backend</span> <span style="color:#e6db74">&#34;s3&#34;</span> {
        bucket <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-james-strong&#34;</span>
        key    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-james-strong/terraform_state&#34;</span>
        region <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;us-west-2&#34;</span>
    }
}
</code></pre></div><h2 id="initialize-the-terraform">Initialize the Terraform</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cd devsecopspipeline/
make tf_clean tf_init
cd terraform/ <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>rm -rf .terraform <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>rm -rf plan.out
cd terraform/ <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>terraform init
Initializing the backend...

Successfully configured the backend <span style="color:#e6db74">&#34;s3&#34;</span>! Terraform will automatically
use this backend unless the backend configuration changes.

Initializing provider plugins...
- Finding hashicorp/aws versions matching <span style="color:#e6db74">&#34;~&gt; 3.0&#34;</span>...
- Installing hashicorp/aws v3.58.0...
- Installed hashicorp/aws v3.58.0 <span style="color:#f92672">(</span>signed by HashiCorp<span style="color:#f92672">)</span>

Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run <span style="color:#e6db74">&#34;terraform init&#34;</span> in the future.

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running <span style="color:#e6db74">&#34;terraform plan&#34;</span> to see
any changes that are required <span style="color:#66d9ef">for</span> your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration <span style="color:#66d9ef">for</span> Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to <span style="color:#66d9ef">do</span> so <span style="color:#66d9ef">if</span> necessary.
</code></pre></div><h2 id="terraform-plan">Terraform Plan</h2>
<p>Terraform Plan</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> make tf_plan
cd terraform/ <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>terraform plan -out<span style="color:#f92672">=</span>plan.out
</code></pre></div>
<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Expand here is what it looks like in its entirety
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <pre><code>aws_iam_policy.allow-eks-asg: Refreshing state... [id=arn:aws:iam::123456789012:policy/eks-devsecops-allow-eks-asg]
aws_s3_bucket.codepipeline_bucket: Refreshing state... [id=houston-devsecops-code]
aws_ecr_repository.golang_example: Refreshing state... [id=golang_example-houston]
aws_codecommit_repository.devsecops: Refreshing state... [id=houston-devsecops-repo]
aws_iam_role.codepipeline_role: Refreshing state... [id=houston-test-role]
aws_iam_role.main: Refreshing state... [id=eks-devsecops]
aws_iam_role.devsecops-austin-codebuild: Refreshing state... [id=devsecops-houston-codebuild]
aws_cloudwatch_log_group.codebuild: Refreshing state... [id=devsecops-houston-codebuild]
aws_s3_bucket.codebuild_s3: Refreshing state... [id=devsecops-houston-codebuild]
aws_cloudwatch_log_stream.codebuild: Refreshing state... [id=devsecops-houston-codebuild]
aws_ssm_parameter.account_id: Refreshing state... [id=ACCOUNT_ID]
aws_codebuild_project.devsecops-austin-codebuild-BUILD: Refreshing state... [id=arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-BUILD]
aws_iam_role_policy_attachment.AmazonEKSClusterPolicy: Refreshing state... [id=devsecops-houston-codebuild-20210911231810453900000003]
aws_iam_role_policy_attachment.AmazonEKSServicePolicy: Refreshing state... [id=devsecops-houston-codebuild-20210911231810424800000002]
aws_iam_role_policy.devsecops-austin-codebuild: Refreshing state... [id=devsecops-houston-codebuild:terraform-20210911231810411800000001]
aws_codebuild_project.devsecops-austin-codebuild-DEPLOY: Refreshing state... [id=arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-DEPLOY]
aws_codebuild_project.devsecops-austin-codebuild-STATIC: Refreshing state... [id=arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-STATIC]
aws_iam_role_policy.codepipeline_policy: Refreshing state... [id=houston-test-role:houston-codepipeline_policy]
aws_codepipeline.codepipeline: Refreshing state... [id=houston-devsecops-pipeline]

Note: Objects have changed outside of Terraform

Terraform detected the following changes made outside of Terraform since the last &quot;terraform apply&quot;:

  # aws_iam_role.main has been changed
  ~ resource &quot;aws_iam_role&quot; &quot;main&quot; {
        id                    = &quot;eks-devsecops&quot;
        name                  = &quot;eks-devsecops&quot;
      + tags                  = {}
        # (10 unchanged attributes hidden)

        # (1 unchanged block hidden)
    }
  # aws_codepipeline.codepipeline has been changed
  ~ resource &quot;aws_codepipeline&quot; &quot;codepipeline&quot; {
        id       = &quot;houston-devsecops-pipeline&quot;
        name     = &quot;houston-devsecops-pipeline&quot;
      + tags     = {}
        # (3 unchanged attributes hidden)


      ~ stage {
            name = &quot;Source&quot;

          ~ action {
              + input_artifacts  = []
                name             = &quot;Source&quot;
                # (7 unchanged attributes hidden)
            }
        }
      ~ stage {
            name = &quot;Build&quot;

          ~ action {
                name             = &quot;Build&quot;
              + output_artifacts = []
                # (7 unchanged attributes hidden)
            }
        }
      ~ stage {
            name = &quot;Deploy&quot;

          ~ action {
                name             = &quot;Deploy&quot;
              + output_artifacts = []
                # (7 unchanged attributes hidden)
            }
        }
        # (2 unchanged blocks hidden)
    }
  # aws_s3_bucket.codepipeline_bucket has been changed
  ~ resource &quot;aws_s3_bucket&quot; &quot;codepipeline_bucket&quot; {
        id                          = &quot;houston-devsecops-code&quot;
      + tags                        = {}
        # (10 unchanged attributes hidden)

        # (1 unchanged block hidden)
    }
  # aws_ssm_parameter.account_id has been changed
  ~ resource &quot;aws_ssm_parameter&quot; &quot;account_id&quot; {
        id        = &quot;ACCOUNT_ID&quot;
        name      = &quot;ACCOUNT_ID&quot;
      + tags      = {}
        # (8 unchanged attributes hidden)
    }
  # aws_codecommit_repository.devsecops has been changed
  ~ resource &quot;aws_codecommit_repository&quot; &quot;devsecops&quot; {
        id              = &quot;houston-devsecops-repo&quot;
      + tags            = {}
        # (8 unchanged attributes hidden)
    }
  # aws_cloudwatch_log_group.codebuild has been changed
  ~ resource &quot;aws_cloudwatch_log_group&quot; &quot;codebuild&quot; {
        id                = &quot;devsecops-houston-codebuild&quot;
        name              = &quot;devsecops-houston-codebuild&quot;
      + tags              = {}
        # (3 unchanged attributes hidden)
    }
  # aws_iam_role.codepipeline_role has been changed
  ~ resource &quot;aws_iam_role&quot; &quot;codepipeline_role&quot; {
        id                    = &quot;houston-test-role&quot;
        name                  = &quot;houston-test-role&quot;
      + tags                  = {}
        # (9 unchanged attributes hidden)

      - inline_policy {}
      + inline_policy {
          + name   = &quot;houston-codepipeline_policy&quot;
          + policy = jsonencode(
                {
                  + Statement = [
                      + {
                          + Action   = [
                              + &quot;s3:GetObject&quot;,
                              + &quot;s3:GetObjectVersion&quot;,
                              + &quot;s3:GetBucketVersioning&quot;,
                              + &quot;s3:PutObject&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = [
                              + &quot;arn:aws:s3:::houston-devsecops-code&quot;,
                              + &quot;arn:aws:s3:::houston-devsecops-code/*&quot;,
                            ]
                        },
                      + {
                          + Action   = [
                              + &quot;codebuild:BatchGetBuilds&quot;,
                              + &quot;codebuild:StartBuild&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = &quot;*&quot;
                        },
                    ]
                  + Version   = &quot;2012-10-17&quot;
                }
            )
        }
    }
  # aws_s3_bucket.codebuild_s3 has been changed
  ~ resource &quot;aws_s3_bucket&quot; &quot;codebuild_s3&quot; {
        id                          = &quot;devsecops-houston-codebuild&quot;
      + tags                        = {}
        # (10 unchanged attributes hidden)

        # (1 unchanged block hidden)
    }
  # aws_iam_role.devsecops-austin-codebuild has been changed
  ~ resource &quot;aws_iam_role&quot; &quot;devsecops-austin-codebuild&quot; {
        id                    = &quot;devsecops-houston-codebuild&quot;
      ~ managed_policy_arns   = [
          + &quot;arn:aws:iam::aws:policy/AmazonEKSClusterPolicy&quot;,
          + &quot;arn:aws:iam::aws:policy/AmazonEKSServicePolicy&quot;,
        ]
        name                  = &quot;devsecops-houston-codebuild&quot;
      + tags                  = {}
        # (8 unchanged attributes hidden)

      - inline_policy {}
      + inline_policy {
          + name   = &quot;terraform-20210911231810411800000001&quot;
          + policy = jsonencode(
                {
                  + Statement = [
                      + {
                          + Action   = [
                              + &quot;logs:CreateLogGroup&quot;,
                              + &quot;logs:CreateLogStream&quot;,
                              + &quot;logs:PutLogEvents&quot;,
                              + &quot;sts:AssumeRole&quot;,
                              + &quot;eks:*&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = [
                              + &quot;*&quot;,
                            ]
                        },
                      + {
                          + Action   = [
                              + &quot;ec2:CreateNetworkInterface&quot;,
                              + &quot;ec2:DescribeDhcpOptions&quot;,
                              + &quot;ec2:DescribeNetworkInterfaces&quot;,
                              + &quot;ec2:DeleteNetworkInterface&quot;,
                              + &quot;ec2:DescribeSubnets&quot;,
                              + &quot;ec2:DescribeSecurityGroups&quot;,
                              + &quot;ec2:DescribeVpcs&quot;,
                              + &quot;ecr:*&quot;,
                              + &quot;ssm:*&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = &quot;*&quot;
                        },
                      + {
                          + Action   = [
                              + &quot;ec2:CreateNetworkInterfacePermission&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = [
                              + &quot;arn:aws:ec2:us-west-2:*:network-interface/*&quot;,
                            ]
                        },
                      + {
                          + Action   = [
                              + &quot;s3:*&quot;,
                            ]
                          + Effect   = &quot;Allow&quot;
                          + Resource = [
                              + &quot;arn:aws:s3:::devsecops-houston-codebuild&quot;,
                              + &quot;arn:aws:s3:::devsecops-houston-codebuild/*&quot;,
                              + &quot;arn:aws:s3:::houston-devsecops-code&quot;,
                              + &quot;arn:aws:s3:::houston-devsecops-code/*&quot;,
                            ]
                        },
                    ]
                  + Version   = &quot;2012-10-17&quot;
                }
            )
        }
    }
  # aws_iam_policy.allow-eks-asg has been changed
  ~ resource &quot;aws_iam_policy&quot; &quot;allow-eks-asg&quot; {
        id        = &quot;arn:aws:iam::123456789012:policy/eks-devsecops-allow-eks-asg&quot;
        name      = &quot;eks-devsecops-allow-eks-asg&quot;
      + tags      = {}
        # (5 unchanged attributes hidden)
    }

Unless you have made equivalent changes to your configuration, or ignored the relevant attributes using ignore_changes, the following plan may include actions to undo or respond to these changes.

───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

No changes. Your infrastructure matches the configuration.

Your configuration already matches the changes detected above. If you'd like to update the Terraform state to match, create and apply a refresh-only plan:
  terraform apply -refresh-only
</code></pre>
    </div>
</div>

<h2 id="terraform-apply">Terraform Apply</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">~/environment/devsecopspipeline <span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> $ make tf_apply
cd terraform/ <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>terraform apply -auto-approve

Terraform used the selected providers to generate the following execution plan. Resource actions are indicated with the following symbols:
+ create
</code></pre></div>
<div class="expand">
    <div class="expand-label" style="cursor: pointer;" onclick="$h = $(this);$h.next('div').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('div').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
        <i style="font-size:x-small;" class="fas fa-chevron-right"></i>
        <span>
        
    	
    	Expand here is what it looks like in its entirety
    	
    	</span>
    </div>
    <div class="expand-content" style="display: none;">
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Terraform will perform the following actions:

<span style="color:#75715e"># aws_cloudwatch_log_group.codebuild will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_cloudwatch_log_group&#34;</span> <span style="color:#e6db74">&#34;codebuild&#34;</span> <span style="color:#f92672">{</span>
    + arn               <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id                <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
    + retention_in_days <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    + tags_all          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_cloudwatch_log_stream.codebuild will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_cloudwatch_log_stream&#34;</span> <span style="color:#e6db74">&#34;codebuild&#34;</span> <span style="color:#f92672">{</span>
    + arn            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + log_group_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
    + name           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_codebuild_project.devsecops-austin-codebuild-BUILD will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_codebuild_project&#34;</span> <span style="color:#e6db74">&#34;devsecops-austin-codebuild-BUILD&#34;</span> <span style="color:#f92672">{</span>
    + arn            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + badge_enabled  <span style="color:#f92672">=</span> false
    + badge_url      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + build_timeout  <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
    + description    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-BUILD&#34;</span>
    + encryption_key <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-BUILD&#34;</span>
    + queued_timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">480</span>
    + service_role   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + source_version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;master&#34;</span>
    + tags           <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>
    + tags_all       <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>

    + artifacts <span style="color:#f92672">{</span>
        + encryption_disabled    <span style="color:#f92672">=</span> false
        + override_artifact_name <span style="color:#f92672">=</span> false
        + type                   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>

    + environment <span style="color:#f92672">{</span>
        + compute_type                <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BUILD_GENERAL1_LARGE&#34;</span>
        + image                       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aws/codebuild/standard:2.0&#34;</span>
        + image_pull_credentials_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEBUILD&#34;</span>
        + privileged_mode             <span style="color:#f92672">=</span> true
        + type                        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LINUX_CONTAINER&#34;</span>

        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PARAMETER_STORE&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
              <span style="color:#f92672">}</span>
        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EKS_KUBECTL_ROLE_NAME&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PLAINTEXT&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + logs_config <span style="color:#f92672">{</span>
        + cloudwatch_logs <span style="color:#f92672">{</span>
            + group_name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
            + status      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
            + stream_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>

        + s3_logs <span style="color:#f92672">{</span>
            + encryption_disabled <span style="color:#f92672">=</span> false
            + location            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + status              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + source <span style="color:#f92672">{</span>
        + buildspec <span style="color:#f92672">=</span> <span style="color:#e6db74">&lt;&lt;-EOT
</span><span style="color:#e6db74">          ---
</span><span style="color:#e6db74">          version: 0.2
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">              phases:
</span><span style="color:#e6db74">                install:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - apt-get update &amp;&amp; apt-get -y install curl jq python3-pip python3-dev &amp;&amp; pip3 install --upgrade awscli
</span><span style="color:#e6db74">                    - curl -sS -o aws-iam-authenticator https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/linux/amd64/aws-iam-authenticator
</span><span style="color:#e6db74">                    - curl -sS -o kubectl https://amazon-eks.s3-us-west-2.amazonaws.com/1.14.6/2019-08-22/bin/linux/amd64/kubectl
</span><span style="color:#e6db74">                    - chmod +x ./kubectl ./aws-iam-authenticator
</span><span style="color:#e6db74">                    - export PATH=$PWD/:$PATH
</span><span style="color:#e6db74">              
</span><span style="color:#e6db74">                pre_build:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - TAG=&#34;$REPOSITORY_NAME.$REPOSITORY_BRANCH.$ENVIRONMENT_NAME.$(date +%Y-%m-%d.%H.%M.%S).$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | head -c 8)&#34;
</span><span style="color:#e6db74">                    - sed -i &#39;s@CONTAINER_IMAGE@&#39;&#34;$REPOSITORY_URI:$TAG&#34;&#39;@&#39; app.yml
</span><span style="color:#e6db74">                    - CREDENTIALS=$(aws sts assume-role --role-arn arn:aws:iam::$ACCOUNT_ID:role/$EKS_KUBECTL_ROLE_NAME --role-session-name codebuild-kubectl --duration-seconds 900)
</span><span style="color:#e6db74">                    - export AWS_ACCESS_KEY_ID=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.AccessKeyId&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_SECRET_ACCESS_KEY=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SecretAccessKey&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_SESSION_TOKEN=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SessionToken&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_EXPIRATION=$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.Expiration&#39;)
</span><span style="color:#e6db74">                    - $(aws ecr get-login --no-include-email)
</span><span style="color:#e6db74">                build:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - make docker_build
</span><span style="color:#e6db74">              
</span><span style="color:#e6db74">                post_build:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - CREDENTIALS=$(aws sts assume-role --role-arn arn:aws:iam::$ACCOUNT_ID:role/$EKS_KUBECTL_ROLE_NAME  --role-session-name codebuild-kubectl --duration-seconds 900)
</span><span style="color:#e6db74">                    - export AWS_ACCESS_KEY_ID=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.AccessKeyId&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_SECRET_ACCESS_KEY=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SecretAccessKey&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_SESSION_TOKEN=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SessionToken&#39;)&#34;
</span><span style="color:#e6db74">                    - export AWS_EXPIRATION=$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.Expiration&#39;)
</span><span style="color:#e6db74">                    - make docker_push
</span><span style="color:#e6db74">              artifacts:
</span><span style="color:#e6db74">                files: build.json
</span><span style="color:#e6db74">          EOT</span>
        + type      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_codebuild_project.devsecops-austin-codebuild-DEPLOY will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_codebuild_project&#34;</span> <span style="color:#e6db74">&#34;devsecops-austin-codebuild-DEPLOY&#34;</span> <span style="color:#f92672">{</span>
    + arn            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + badge_enabled  <span style="color:#f92672">=</span> false
    + badge_url      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + build_timeout  <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
    + description    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-DEPLOY&#34;</span>
    + encryption_key <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-DEPLOY&#34;</span>
    + queued_timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">480</span>
    + service_role   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + source_version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;master&#34;</span>
    + tags           <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>
    + tags_all       <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>

    + artifacts <span style="color:#f92672">{</span>
        + encryption_disabled    <span style="color:#f92672">=</span> false
        + override_artifact_name <span style="color:#f92672">=</span> false
        + type                   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>

    + environment <span style="color:#f92672">{</span>
        + compute_type                <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BUILD_GENERAL1_LARGE&#34;</span>
        + image                       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aws/codebuild/standard:2.0&#34;</span>
        + image_pull_credentials_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEBUILD&#34;</span>
        + privileged_mode             <span style="color:#f92672">=</span> true
        + type                        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LINUX_CONTAINER&#34;</span>

        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PARAMETER_STORE&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
              <span style="color:#f92672">}</span>
        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EKS_KUBECTL_ROLE_NAME&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PLAINTEXT&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + logs_config <span style="color:#f92672">{</span>
        + cloudwatch_logs <span style="color:#f92672">{</span>
            + group_name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
            + status      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
            + stream_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>

        + s3_logs <span style="color:#f92672">{</span>
            + encryption_disabled <span style="color:#f92672">=</span> false
            + location            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + status              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + source <span style="color:#f92672">{</span>
        + buildspec <span style="color:#f92672">=</span> <span style="color:#e6db74">&lt;&lt;-EOT
</span><span style="color:#e6db74">          ---
</span><span style="color:#e6db74">          version: 0.2
</span><span style="color:#e6db74">          phases:
</span><span style="color:#e6db74">          install:
</span><span style="color:#e6db74">          commands:
</span><span style="color:#e6db74">          - curl -sS -o aws-iam-authenticator https://amazon-eks.s3-us-west-2.amazonaws.com/1.10.3/2018-07-26/bin/linux/amd64/aws-iam-authenticator
</span><span style="color:#e6db74">          - curl -sS -o kubectl https://amazon-eks.s3-us-west-2.amazonaws.com/1.14.6/2019-08-22/bin/linux/amd64/kubectl
</span><span style="color:#e6db74">          - chmod +x ./kubectl ./aws-iam-authenticator
</span><span style="color:#e6db74">          - export PATH=$PWD/:$PATH
</span><span style="color:#e6db74">          - apt-get update &amp;&amp; apt-get -y install jq python3-pip python3-dev &amp;&amp; pip3 install --upgrade awscli
</span><span style="color:#e6db74">          pre_build:
</span><span style="color:#e6db74">          commands:
</span><span style="color:#e6db74">          - TAG=&#34;$REPOSITORY_NAME.$REPOSITORY_BRANCH.$ENVIRONMENT_NAME.$(date +%Y-%m-%d.%H.%M.%S).$(echo $CODEBUILD_RESOLVED_SOURCE_VERSION | head -c 8)&#34;
</span><span style="color:#e6db74">          - sed -i &#39;s@CONTAINER_IMAGE@&#39;&#34;$REPOSITORY_URI:$TAG&#34;&#39;@&#39; app.yml
</span><span style="color:#e6db74">          - cat app.yml
</span><span style="color:#e6db74">          - $(aws ecr get-login --no-include-email)
</span><span style="color:#e6db74">          - export KUBECONFIG=$HOME/.kube/config
</span><span style="color:#e6db74">          build:
</span><span style="color:#e6db74">          commands:
</span><span style="color:#e6db74">          - CREDENTIALS=$(aws sts assume-role --role-arn arn:aws:iam::$ACCOUNT_ID:role/$EKS_KUBECTL_ROLE_NAME --role-session-name codebuild-kubectl --duration-seconds 900)
</span><span style="color:#e6db74">          - export AWS_ACCESS_KEY_ID=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.AccessKeyId&#39;)&#34;
</span><span style="color:#e6db74">          - export AWS_SECRET_ACCESS_KEY=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SecretAccessKey&#39;)&#34;
</span><span style="color:#e6db74">          - export AWS_SESSION_TOKEN=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.SessionToken&#39;)&#34;
</span><span style="color:#e6db74">          - export AWS_EXPIRATION=&#34;$(echo ${CREDENTIALS} | jq -r &#39;.Credentials.Expiration&#39;)&#34;
</span><span style="color:#e6db74">          - echo &#34;EKS Cluster Name ${EKS_CLUSTER_NAME}&#34;
</span><span style="color:#e6db74">          - make kube_update
</span><span style="color:#e6db74">          - kubectl apply -f app.yml --kubeconfig /root/.kube/config
</span><span style="color:#e6db74">          post_build:
</span><span style="color:#e6db74">          commands:
</span><span style="color:#e6db74">          - kubectl get pods -l app=devsecopspipeline
</span><span style="color:#e6db74">          artifacts:
</span><span style="color:#e6db74">          files: build.json
</span><span style="color:#e6db74">          EOT</span>
        + type      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_codebuild_project.devsecops-austin-codebuild-STATIC will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_codebuild_project&#34;</span> <span style="color:#e6db74">&#34;devsecops-austin-codebuild-STATIC&#34;</span> <span style="color:#f92672">{</span>
    + arn            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + badge_enabled  <span style="color:#f92672">=</span> false
    + badge_url      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + build_timeout  <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
    + description    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-STATIC&#34;</span>
    + encryption_key <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-STATIC&#34;</span>
    + queued_timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">480</span>
    + service_role   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + source_version <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;master&#34;</span>
    + tags           <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>
    + tags_all       <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;Environment&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston&#34;</span>
          <span style="color:#f92672">}</span>

    + artifacts <span style="color:#f92672">{</span>
        + artifact_identifier    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;static-code-report&#34;</span>
        + encryption_disabled    <span style="color:#f92672">=</span> false
        + override_artifact_name <span style="color:#f92672">=</span> false
        + type                   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>

    + environment <span style="color:#f92672">{</span>
        + compute_type                <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;BUILD_GENERAL1_LARGE&#34;</span>
        + image                       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aws/codebuild/standard:2.0&#34;</span>
        + image_pull_credentials_type <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEBUILD&#34;</span>
        + privileged_mode             <span style="color:#f92672">=</span> true
        + type                        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;LINUX_CONTAINER&#34;</span>

        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PARAMETER_STORE&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
              <span style="color:#f92672">}</span>
        + environment_variable <span style="color:#f92672">{</span>
            + name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;EKS_KUBECTL_ROLE_NAME&#34;</span>
            + type  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;PLAINTEXT&#34;</span>
            + value <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + logs_config <span style="color:#f92672">{</span>
        + cloudwatch_logs <span style="color:#f92672">{</span>
            + group_name  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
            + status      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
            + stream_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
              <span style="color:#f92672">}</span>

        + s3_logs <span style="color:#f92672">{</span>
            + encryption_disabled <span style="color:#f92672">=</span> false
            + location            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + status              <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ENABLED&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

    + source <span style="color:#f92672">{</span>
        + buildspec <span style="color:#f92672">=</span> <span style="color:#e6db74">&lt;&lt;-EOT
</span><span style="color:#e6db74">          ---
</span><span style="color:#e6db74">          version: 0.2
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">              phases:
</span><span style="color:#e6db74">                install:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - make go_version
</span><span style="color:#e6db74">                    - apt-get update &amp;&amp; apt-get -y install curl jq
</span><span style="color:#e6db74">                    - curl -o go1.13.5.linux-amd64.tar.gz https://dl.google.com/go/go1.13.5.linux-amd64.tar.gz
</span><span style="color:#e6db74">                    - tar -C /usr/local -xzf go1.13.5.linux-amd64.tar.gz
</span><span style="color:#e6db74">                    - export PATH=${PATH}:/usr/local/go/bin
</span><span style="color:#e6db74">                    - export GOROOT=/usr/local/go
</span><span style="color:#e6db74">                    - go version
</span><span style="color:#e6db74">                build:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - export PATH=${PATH}:/usr/local/go/bin
</span><span style="color:#e6db74">                    - export GOROOT=/usr/local/go
</span><span style="color:#e6db74">                    - make go_report
</span><span style="color:#e6db74">                post_build:
</span><span style="color:#e6db74">                  commands:
</span><span style="color:#e6db74">                    - mv src-*.html devsecopspipeline.html
</span><span style="color:#e6db74">              artifacts:
</span><span style="color:#e6db74">                files:
</span><span style="color:#e6db74">                  - devsecopspipeline.html
</span><span style="color:#e6db74">                name: static-code-report
</span><span style="color:#e6db74">          EOT</span>
        + type      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CODEPIPELINE&#34;</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_codecommit_repository.devsecops will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_codecommit_repository&#34;</span> <span style="color:#e6db74">&#34;devsecops&#34;</span> <span style="color:#f92672">{</span>
    + arn             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + clone_url_http  <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + clone_url_ssh   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + default_branch  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;main&#34;</span>
    + description     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;This is the Sample App Repository for AWS DevSecOps Workshop&#34;</span>
    + id              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + repository_id   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + repository_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-devsecops-repo&#34;</span>
    + tags_all        <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_codepipeline.codepipeline will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_codepipeline&#34;</span> <span style="color:#e6db74">&#34;codepipeline&#34;</span> <span style="color:#f92672">{</span>
    + arn      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-devsecops-pipeline&#34;</span>
    + role_arn <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tags_all <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + artifact_store <span style="color:#f92672">{</span>
        + location <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-devsecops-code&#34;</span>
        + region   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + type     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;S3&#34;</span>
          <span style="color:#f92672">}</span>

    + stage <span style="color:#f92672">{</span>
        + name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Source&#34;</span>

        + action <span style="color:#f92672">{</span>
            + category         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Source&#34;</span>
            + configuration    <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
                + <span style="color:#e6db74">&#34;BranchName&#34;</span>     <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;main&#34;</span>
                + <span style="color:#e6db74">&#34;RepositoryName&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-devsecops-repo&#34;</span>
                  <span style="color:#f92672">}</span>
            + name             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Source&#34;</span>
            + output_artifacts <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
                + <span style="color:#e6db74">&#34;source_output&#34;</span>,
                  <span style="color:#f92672">]</span>
            + owner            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AWS&#34;</span>
            + provider         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CodeCommit&#34;</span>
            + region           <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + run_order        <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + version          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>
    + stage <span style="color:#f92672">{</span>
        + name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Report&#34;</span>

        + action <span style="color:#f92672">{</span>
            + category         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Test&#34;</span>
            + configuration    <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
                + <span style="color:#e6db74">&#34;ProjectName&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-STATIC&#34;</span>
                  <span style="color:#f92672">}</span>
            + input_artifacts  <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
                + <span style="color:#e6db74">&#34;source_output&#34;</span>,
                  <span style="color:#f92672">]</span>
            + name             <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Report&#34;</span>
            + output_artifacts <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
                + <span style="color:#e6db74">&#34;static_output&#34;</span>,
                  <span style="color:#f92672">]</span>
            + owner            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AWS&#34;</span>
            + provider         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CodeBuild&#34;</span>
            + region           <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + run_order        <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + version          <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>
    + stage <span style="color:#f92672">{</span>
        + name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Build&#34;</span>

        + action <span style="color:#f92672">{</span>
            + category        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Build&#34;</span>
            + configuration   <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
                + <span style="color:#e6db74">&#34;ProjectName&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-BUILD&#34;</span>
                  <span style="color:#f92672">}</span>
            + input_artifacts <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
                + <span style="color:#e6db74">&#34;source_output&#34;</span>,
                  <span style="color:#f92672">]</span>
            + name            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Build&#34;</span>
            + owner           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AWS&#34;</span>
            + provider        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CodeBuild&#34;</span>
            + region          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + run_order       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + version         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>
    + stage <span style="color:#f92672">{</span>
        + name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Deploy&#34;</span>

        + action <span style="color:#f92672">{</span>
            + category        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Build&#34;</span>
            + configuration   <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
                + <span style="color:#e6db74">&#34;ProjectName&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild-DEPLOY&#34;</span>
                  <span style="color:#f92672">}</span>
            + input_artifacts <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
                + <span style="color:#e6db74">&#34;source_output&#34;</span>,
                  <span style="color:#f92672">]</span>
            + name            <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Deploy&#34;</span>
            + owner           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AWS&#34;</span>
            + provider        <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;CodeBuild&#34;</span>
            + region          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + run_order       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
            + version         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1&#34;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>
              <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_ecr_repository.golang_example will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_ecr_repository&#34;</span> <span style="color:#e6db74">&#34;golang_example&#34;</span> <span style="color:#f92672">{</span>
    + arn                  <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id                   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + image_tag_mutability <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;IMMUTABLE&#34;</span>
    + name                 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;golang_example-houston&#34;</span>
    + registry_id          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + repository_url       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tags                 <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;env&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops&#34;</span>
          <span style="color:#f92672">}</span>
    + tags_all             <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
        + <span style="color:#e6db74">&#34;env&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops&#34;</span>
          <span style="color:#f92672">}</span>

    + image_scanning_configuration <span style="color:#f92672">{</span>
        + scan_on_push <span style="color:#f92672">=</span> true
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_policy.allow-eks-asg will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_policy&#34;</span> <span style="color:#e6db74">&#34;allow-eks-asg&#34;</span> <span style="color:#f92672">{</span>
    + arn       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id        <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eks-devsecops-allow-eks-asg&#34;</span>
    + path      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>
    + policy    <span style="color:#f92672">=</span> jsonencode<span style="color:#f92672">(</span>
      <span style="color:#f92672">{</span>
      + Statement <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      + <span style="color:#f92672">{</span>
      + Action   <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      + <span style="color:#e6db74">&#34;autoscaling:DescribeAutoScalingGroups&#34;</span>,
      + <span style="color:#e6db74">&#34;autoscaling:DescribeAutoScalingInstances&#34;</span>,
      + <span style="color:#e6db74">&#34;autoscaling:DescribeLaunchConfigurations&#34;</span>,
      + <span style="color:#e6db74">&#34;autoscaling:SetDesiredCapacity&#34;</span>,
      + <span style="color:#e6db74">&#34;autoscaling:TerminateInstanceInAutoScalingGroup&#34;</span>,
      + <span style="color:#e6db74">&#34;autoscaling:DescribeTags&#34;</span>,
      + <span style="color:#e6db74">&#34;ec2:DescribeLaunchTemplateVersions&#34;</span>,
      + <span style="color:#e6db74">&#34;eks:*&#34;</span>,
      <span style="color:#f92672">]</span>
      + Effect   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>
      + Resource <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;*&#34;</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">]</span>
      + Version   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">)</span>
    + policy_id <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tags_all  <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role.codepipeline_role will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role&#34;</span> <span style="color:#e6db74">&#34;codepipeline_role&#34;</span> <span style="color:#f92672">{</span>
    + arn                   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + assume_role_policy    <span style="color:#f92672">=</span> jsonencode<span style="color:#f92672">(</span>
      <span style="color:#f92672">{</span>
      + Statement <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      + <span style="color:#f92672">{</span>
      + Action    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sts:AssumeRole&#34;</span>
      + Effect    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>
      + Principal <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
      + Service <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;codepipeline.amazonaws.com&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">]</span>
      + Version   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">)</span>
    + create_date           <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + force_detach_policies <span style="color:#f92672">=</span> false
    + id                    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + managed_policy_arns   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + max_session_duration  <span style="color:#f92672">=</span> <span style="color:#ae81ff">3600</span>
    + name                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-test-role&#34;</span>
    + path                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>
    + tags_all              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + unique_id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + inline_policy <span style="color:#f92672">{</span>
        + name   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + policy <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role.devsecops-austin-codebuild will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role&#34;</span> <span style="color:#e6db74">&#34;devsecops-austin-codebuild&#34;</span> <span style="color:#f92672">{</span>
    + arn                   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + assume_role_policy    <span style="color:#f92672">=</span> jsonencode<span style="color:#f92672">(</span>
      <span style="color:#f92672">{</span>
      + Statement <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      + <span style="color:#f92672">{</span>
      + Action    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sts:AssumeRole&#34;</span>
      + Effect    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>
      + Principal <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
      + Service <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;codebuild.amazonaws.com&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">]</span>
      + Version   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">)</span>
    + create_date           <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + force_detach_policies <span style="color:#f92672">=</span> false
    + id                    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + managed_policy_arns   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + max_session_duration  <span style="color:#f92672">=</span> <span style="color:#ae81ff">3600</span>
    + name                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
    + path                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>
    + tags_all              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + unique_id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + inline_policy <span style="color:#f92672">{</span>
        + name   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + policy <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role.main will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role&#34;</span> <span style="color:#e6db74">&#34;main&#34;</span> <span style="color:#f92672">{</span>
    + arn                   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + assume_role_policy    <span style="color:#f92672">=</span> jsonencode<span style="color:#f92672">(</span>
      <span style="color:#f92672">{</span>
      + Statement <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>
      + <span style="color:#f92672">{</span>
      + Action    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sts:AssumeRole&#34;</span>
      + Effect    <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Allow&#34;</span>
      + Principal <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
      + Service <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eks.amazonaws.com&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>,
      <span style="color:#f92672">]</span>
      + Version   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2012-10-17&#34;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#f92672">)</span>
    + create_date           <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + description           <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Role for eks service&#34;</span>
    + force_detach_policies <span style="color:#f92672">=</span> false
    + id                    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + managed_policy_arns   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + max_session_duration  <span style="color:#f92672">=</span> <span style="color:#ae81ff">3600</span>
    + name                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;eks-devsecops&#34;</span>
    + path                  <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;/&#34;</span>
    + tags_all              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + unique_id             <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + inline_policy <span style="color:#f92672">{</span>
        + name   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + policy <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role_policy.codepipeline_policy will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role_policy&#34;</span> <span style="color:#e6db74">&#34;codepipeline_policy&#34;</span> <span style="color:#f92672">{</span>
    + id     <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-codepipeline_policy&#34;</span>
    + policy <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + role   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role_policy.devsecops-austin-codebuild will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role_policy&#34;</span> <span style="color:#e6db74">&#34;devsecops-austin-codebuild&#34;</span> <span style="color:#f92672">{</span>
    + id     <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + policy <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + role   <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role_policy_attachment.AmazonEKSClusterPolicy will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34;</span> <span style="color:#e6db74">&#34;AmazonEKSClusterPolicy&#34;</span> <span style="color:#f92672">{</span>
    + id         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEKSClusterPolicy&#34;</span>
    + role       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_iam_role_policy_attachment.AmazonEKSServicePolicy will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_iam_role_policy_attachment&#34;</span> <span style="color:#e6db74">&#34;AmazonEKSServicePolicy&#34;</span> <span style="color:#f92672">{</span>
    + id         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + policy_arn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arn:aws:iam::aws:policy/AmazonEKSServicePolicy&#34;</span>
    + role       <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
      <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_s3_bucket.codebuild_s3 will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_s3_bucket&#34;</span> <span style="color:#e6db74">&#34;codebuild_s3&#34;</span> <span style="color:#f92672">{</span>
    + acceleration_status         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + acl                         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;private&#34;</span>
    + arn                         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + bucket                      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;devsecops-houston-codebuild&#34;</span>
    + bucket_domain_name          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + bucket_regional_domain_name <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + force_destroy               <span style="color:#f92672">=</span> false
    + hosted_zone_id              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id                          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + region                      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + request_payer               <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tags_all                    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + website_domain              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + website_endpoint            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + versioning <span style="color:#f92672">{</span>
        + enabled    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + mfa_delete <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_s3_bucket.codepipeline_bucket will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_s3_bucket&#34;</span> <span style="color:#e6db74">&#34;codepipeline_bucket&#34;</span> <span style="color:#f92672">{</span>
    + acceleration_status         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + acl                         <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;private&#34;</span>
    + arn                         <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + bucket                      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;houston-devsecops-code&#34;</span>
    + bucket_domain_name          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + bucket_regional_domain_name <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + force_destroy               <span style="color:#f92672">=</span> false
    + hosted_zone_id              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id                          <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + region                      <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + request_payer               <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tags_all                    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + website_domain              <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + website_endpoint            <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>

    + versioning <span style="color:#f92672">{</span>
        + enabled    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
        + mfa_delete <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
          <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>

<span style="color:#75715e"># aws_ssm_parameter.account_id will be created</span>
+ resource <span style="color:#e6db74">&#34;aws_ssm_parameter&#34;</span> <span style="color:#e6db74">&#34;account_id&#34;</span> <span style="color:#f92672">{</span>
    + arn       <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + data_type <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + id        <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + key_id    <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + name      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ACCOUNT_ID&#34;</span>
    + overwrite <span style="color:#f92672">=</span> true
    + tags_all  <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
    + tier      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Standard&#34;</span>
    + type      <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;String&#34;</span>
    + value     <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>sensitive value<span style="color:#f92672">)</span>
    + version   <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>known after apply<span style="color:#f92672">)</span>
      <span style="color:#f92672">}</span>

Plan: <span style="color:#ae81ff">19</span> to add, <span style="color:#ae81ff">0</span> to change, <span style="color:#ae81ff">0</span> to destroy.
aws_cloudwatch_log_group.codebuild: Creating...
aws_iam_role.codepipeline_role: Creating...
aws_ssm_parameter.account_id: Creating...
aws_iam_role.devsecops-austin-codebuild: Creating...
aws_ecr_repository.golang_example: Creating...
aws_iam_role.main: Creating...
aws_s3_bucket.codepipeline_bucket: Creating...
aws_codecommit_repository.devsecops: Creating...
aws_iam_policy.allow-eks-asg: Creating...
aws_s3_bucket.codebuild_s3: Creating...
aws_cloudwatch_log_group.codebuild: Creation complete after 0s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild<span style="color:#f92672">]</span>
aws_cloudwatch_log_stream.codebuild: Creating...
aws_ecr_repository.golang_example: Creation complete after 0s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>golang_example-houston<span style="color:#f92672">]</span>
aws_cloudwatch_log_stream.codebuild: Creation complete after 0s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild<span style="color:#f92672">]</span>
aws_ssm_parameter.account_id: Creation complete after 0s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>ACCOUNT_ID<span style="color:#f92672">]</span>
aws_codecommit_repository.devsecops: Creation complete after 0s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>houston-devsecops-repo<span style="color:#f92672">]</span>
aws_iam_policy.allow-eks-asg: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>arn:aws:iam::123456789012:policy/eks-devsecops-allow-eks-asg<span style="color:#f92672">]</span>
aws_iam_role.devsecops-austin-codebuild: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild<span style="color:#f92672">]</span>
aws_iam_role_policy_attachment.AmazonEKSServicePolicy: Creating...
aws_iam_role_policy_attachment.AmazonEKSClusterPolicy: Creating...
aws_iam_role.main: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>eks-devsecops<span style="color:#f92672">]</span>
aws_s3_bucket.codebuild_s3: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild<span style="color:#f92672">]</span>
aws_iam_role.codepipeline_role: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>houston-test-role<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-DEPLOY: Creating...
aws_codebuild_project.devsecops-austin-codebuild-BUILD: Creating...
aws_codebuild_project.devsecops-austin-codebuild-STATIC: Creating...
aws_s3_bucket.codepipeline_bucket: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>houston-devsecops-code<span style="color:#f92672">]</span>
aws_iam_role_policy.devsecops-austin-codebuild: Creating...
aws_iam_role_policy.codepipeline_policy: Creating...
aws_codepipeline.codepipeline: Creating...
aws_iam_role_policy_attachment.AmazonEKSServicePolicy: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild-20210911231810424800000002<span style="color:#f92672">]</span>
aws_iam_role_policy_attachment.AmazonEKSClusterPolicy: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild-20210911231810453900000003<span style="color:#f92672">]</span>
aws_iam_role_policy.codepipeline_policy: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>houston-test-role:houston-codepipeline_policy<span style="color:#f92672">]</span>
aws_iam_role_policy.devsecops-austin-codebuild: Creation complete after 1s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>devsecops-houston-codebuild:terraform-20210911231810411800000001<span style="color:#f92672">]</span>
aws_codepipeline.codepipeline: Creation complete after 9s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>houston-devsecops-pipeline<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-DEPLOY: Still creating... <span style="color:#f92672">[</span>10s elapsed<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-STATIC: Still creating... <span style="color:#f92672">[</span>10s elapsed<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-BUILD: Still creating... <span style="color:#f92672">[</span>10s elapsed<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-BUILD: Creation complete after 16s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-BUILD<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-STATIC: Creation complete after 16s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-STATIC<span style="color:#f92672">]</span>
aws_codebuild_project.devsecops-austin-codebuild-DEPLOY: Creation complete after 16s <span style="color:#f92672">[</span>id<span style="color:#f92672">=</span>arn:aws:codebuild:us-west-2:123456789012:project/devsecops-houston-codebuild-DEPLOY<span style="color:#f92672">]</span>

Apply complete! Resources: <span style="color:#ae81ff">19</span> added, <span style="color:#ae81ff">0</span> changed, <span style="color:#ae81ff">0</span> destroyed.
</code></pre></div>
    </div>
</div>

<h2 id="heading"></h2>

<div class="notices info" ><p>You may need to start docker</p>
</div>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo service docker start                                                                                                                                
Redirecting to /bin/systemctl start docker.service
</code></pre></div><h2 id="aws-ecr">AWS ECR</h2>
<p>Let&rsquo;s push our docker image to ECR that was created from Terraform</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">~/environment/devsecopspipeline <span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> $ make docker_push
docker login -u AWS -p redacted https://123456789012.dkr.ecr.us-west-2.amazonaws.com
WARNING! Using --password via the CLI is insecure. Use --password-stdin.
WARNING! Your password will be stored unencrypted in /home/ec2-user/.docker/config.json.
Configure a credential helper to remove this warning. See
https://docs.docker.com/engine/reference/commandline/login/#credentials-store

Login Succeeded
docker build -t 123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston:0.1.20 .
Sending build context to Docker daemon  198.3MB
Step 1/10 : FROM golang:1.13-alpine AS builder
 ---&gt; 5863598a981a
Step 2/10 : RUN apk update <span style="color:#f92672">&amp;&amp;</span> apk add --no-cache git
 ---&gt; Using cache
 ---&gt; 38f3e2c68459
Step 3/10 : WORKDIR /go/src/app
 ---&gt; Using cache
 ---&gt; 7cfc77561295
Step 4/10 : COPY . .
 ---&gt; a6c705d6dc6a
Step 5/10 : RUN GIT_TERMINAL_PROMPT<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> go get -d -v
 ---&gt; Running in 96f459e87b9c
github.com/strongjz/go_example_app <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/gin-gonic/gin <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/gin-contrib/sse <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/go-playground/validator <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/go-playground/universal-translator <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/go-playground/locales <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/leodido/go-urn <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
get <span style="color:#e6db74">&#34;golang.org/x/crypto/sha3&#34;</span>: found meta tag get.metaImport<span style="color:#f92672">{</span>Prefix:<span style="color:#e6db74">&#34;golang.org/x/crypto&#34;</span>, VCS:<span style="color:#e6db74">&#34;git&#34;</span>, RepoRoot:<span style="color:#e6db74">&#34;https://go.googlesource.com/crypto&#34;</span><span style="color:#f92672">}</span> at //golang.org/x/crypto/sha3?go-get<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
get <span style="color:#e6db74">&#34;golang.org/x/crypto/sha3&#34;</span>: verifying non-authoritative meta tag
golang.org/x/crypto <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
get <span style="color:#e6db74">&#34;golang.org/x/text/language&#34;</span>: found meta tag get.metaImport<span style="color:#f92672">{</span>Prefix:<span style="color:#e6db74">&#34;golang.org/x/text&#34;</span>, VCS:<span style="color:#e6db74">&#34;git&#34;</span>, RepoRoot:<span style="color:#e6db74">&#34;https://go.googlesource.com/text&#34;</span><span style="color:#f92672">}</span> at //golang.org/x/text/language?go-get<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
get <span style="color:#e6db74">&#34;golang.org/x/text/language&#34;</span>: verifying non-authoritative meta tag
golang.org/x/text <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/ugorji/go <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
get <span style="color:#e6db74">&#34;google.golang.org/protobuf/proto&#34;</span>: found meta tag get.metaImport<span style="color:#f92672">{</span>Prefix:<span style="color:#e6db74">&#34;google.golang.org/protobuf&#34;</span>, VCS:<span style="color:#e6db74">&#34;git&#34;</span>, RepoRoot:<span style="color:#e6db74">&#34;https://go.googlesource.com/protobuf&#34;</span><span style="color:#f92672">}</span> at //google.golang.org/protobuf/proto?go-get<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
get <span style="color:#e6db74">&#34;google.golang.org/protobuf/proto&#34;</span>: verifying non-authoritative meta tag
google.golang.org/protobuf <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
get <span style="color:#e6db74">&#34;gopkg.in/yaml.v2&#34;</span>: found meta tag get.metaImport<span style="color:#f92672">{</span>Prefix:<span style="color:#e6db74">&#34;gopkg.in/yaml.v2&#34;</span>, VCS:<span style="color:#e6db74">&#34;git&#34;</span>, RepoRoot:<span style="color:#e6db74">&#34;https://gopkg.in/yaml.v2&#34;</span><span style="color:#f92672">}</span> at //gopkg.in/yaml.v2?go-get<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
gopkg.in/yaml.v2 <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/mattn/go-isatty <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
get <span style="color:#e6db74">&#34;golang.org/x/sys/unix&#34;</span>: found meta tag get.metaImport<span style="color:#f92672">{</span>Prefix:<span style="color:#e6db74">&#34;golang.org/x/sys&#34;</span>, VCS:<span style="color:#e6db74">&#34;git&#34;</span>, RepoRoot:<span style="color:#e6db74">&#34;https://go.googlesource.com/sys&#34;</span><span style="color:#f92672">}</span> at //golang.org/x/sys/unix?go-get<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
get <span style="color:#e6db74">&#34;golang.org/x/sys/unix&#34;</span>: verifying non-authoritative meta tag
golang.org/x/sys <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
github.com/lib/pq <span style="color:#f92672">(</span>download<span style="color:#f92672">)</span>
Removing intermediate container 96f459e87b9c
 ---&gt; 953ff65afc5d
Step 6/10 : RUN CGO_ENABLED<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span> go build -o /go/bin/app
 ---&gt; Running in 49da19462426
Removing intermediate container 49da19462426
 ---&gt; 7e9d11bad96b
Step 7/10 : FROM golang:1.13-alpine
 ---&gt; 5863598a981a
Step 8/10 : COPY --from<span style="color:#f92672">=</span>builder /go/bin/app /go/bin/app
 ---&gt; Using cache
 ---&gt; abf4839e8c6b
Step 9/10 : EXPOSE <span style="color:#ae81ff">8080</span>
 ---&gt; Using cache
 ---&gt; 62583b2da3ce
Step 10/10 : CMD <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;/go/bin/app&#34;</span><span style="color:#f92672">]</span>
 ---&gt; Using cache
 ---&gt; 20b885db4549
Successfully built 20b885db4549
Successfully tagged 123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston:0.1.20
docker push 123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston:0.1.20
The push refers to repository <span style="color:#f92672">[</span>123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston<span style="color:#f92672">]</span>
6223903865fc: Pushed 
39c40114257b: Pushed 
08161ff6b353: Pushed 
1ba1431fe2ba: Pushed 
0f7493e3a35b: Pushed 
50644c29ef5a: Pushed 
0.1.20: digest: sha256:256531371d0ca8da6d1aa13ad63579f887a1c5e8e2de25136bface4e3e13ccd4 size: <span style="color:#ae81ff">1576</span>
</code></pre></div><h3 id="ecr-scans-our-images-for-vulnerabilities">ECR scans our images for vulnerabilities</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> make ecr_scan_findings
aws ecr describe-image-scan-findings --repository-name golang_example-houston --image-id imageTag<span style="color:#f92672">=</span>0.1.20
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;imageScanStatus&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;COMPLETE&#34;</span>, 
        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;The scan was completed successfully.&#34;</span>
    <span style="color:#f92672">}</span>, 
    <span style="color:#e6db74">&#34;repositoryName&#34;</span>: <span style="color:#e6db74">&#34;golang_example-houston&#34;</span>, 
    <span style="color:#e6db74">&#34;registryId&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>, 
    <span style="color:#e6db74">&#34;imageId&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;imageTag&#34;</span>: <span style="color:#e6db74">&#34;0.1.20&#34;</span>, 
        <span style="color:#e6db74">&#34;imageDigest&#34;</span>: <span style="color:#e6db74">&#34;sha256:256531371d0ca8da6d1aa13ad63579f887a1c5e8e2de25136bface4e3e13ccd4&#34;</span>
    <span style="color:#f92672">}</span>, 
    <span style="color:#e6db74">&#34;imageScanFindings&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;imageScanCompletedAt&#34;</span>: 1631403103.0, 
        <span style="color:#e6db74">&#34;vulnerabilitySourceUpdatedAt&#34;</span>: 1631377466.0, 
        <span style="color:#e6db74">&#34;findings&#34;</span>: <span style="color:#f92672">[</span>
            <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;MEDIUM&#34;</span>, 
                <span style="color:#e6db74">&#34;attributes&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;2.10.5-r1&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_version&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;apk-tools&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_name&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;AV:N/AC:L/Au:N/C:N/I:N/A:P&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_VECTOR&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;5&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_SCORE&#34;</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">]</span>, 
                <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;CVE-2021-30139&#34;</span>, 
                <span style="color:#e6db74">&#34;uri&#34;</span>: <span style="color:#e6db74">&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30139&#34;</span>
            <span style="color:#f92672">}</span>, 
            <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;MEDIUM&#34;</span>, 
                <span style="color:#e6db74">&#34;attributes&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;2.10.5-r1&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_version&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;apk-tools&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_name&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;AV:N/AC:L/Au:N/C:P/I:N/A:P&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_VECTOR&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;6.4&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_SCORE&#34;</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">]</span>, 
                <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;CVE-2021-36159&#34;</span>, 
                <span style="color:#e6db74">&#34;uri&#34;</span>: <span style="color:#e6db74">&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36159&#34;</span>
            <span style="color:#f92672">}</span>, 
            <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;MEDIUM&#34;</span>, 
                <span style="color:#e6db74">&#34;attributes&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;1.31.1-r16&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_version&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;busybox&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_name&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;AV:N/AC:L/Au:N/C:N/I:N/A:P&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_VECTOR&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;5&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_SCORE&#34;</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">]</span>, 
                <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;CVE-2021-28831&#34;</span>, 
                <span style="color:#e6db74">&#34;uri&#34;</span>: <span style="color:#e6db74">&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-28831&#34;</span>
            <span style="color:#f92672">}</span>, 
            <span style="color:#f92672">{</span>
                <span style="color:#e6db74">&#34;severity&#34;</span>: <span style="color:#e6db74">&#34;LOW&#34;</span>, 
                <span style="color:#e6db74">&#34;attributes&#34;</span>: <span style="color:#f92672">[</span>
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;1.1.24-r9&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_version&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;musl&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;package_name&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;AV:L/AC:L/Au:N/C:N/I:N/A:P&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_VECTOR&#34;</span>
                    <span style="color:#f92672">}</span>, 
                    <span style="color:#f92672">{</span>
                        <span style="color:#e6db74">&#34;value&#34;</span>: <span style="color:#e6db74">&#34;2.1&#34;</span>, 
                        <span style="color:#e6db74">&#34;key&#34;</span>: <span style="color:#e6db74">&#34;CVSS2_SCORE&#34;</span>
                    <span style="color:#f92672">}</span>
                <span style="color:#f92672">]</span>, 
                <span style="color:#e6db74">&#34;name&#34;</span>: <span style="color:#e6db74">&#34;CVE-2020-28928&#34;</span>, 
                <span style="color:#e6db74">&#34;uri&#34;</span>: <span style="color:#e6db74">&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28928&#34;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">]</span>, 
        <span style="color:#e6db74">&#34;findingSeverityCounts&#34;</span>: <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;MEDIUM&#34;</span>: 3, 
            <span style="color:#e6db74">&#34;LOW&#34;</span>: <span style="color:#ae81ff">1</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><img src="/images/pipeline/ecr-scan.png" alt=""></p>
<h3 id="lets-reduce-our-image-size">Let&rsquo;s reduce our image size</h3>
<p>Update your Dockerfile</p>
<p><code>FROM golang:1.13-alpine</code>
to</p>
<p><code>FROM scratch</code></p>
<p>you should get an error</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tag invalid: The image tag <span style="color:#e6db74">&#39;0.1.20&#39;</span> already exists in the <span style="color:#e6db74">&#39;golang_example-houston&#39;</span> repository and cannot be overwritten because the repository is immutable.
make: *** <span style="color:#f92672">[</span>docker_push<span style="color:#f92672">]</span> Error <span style="color:#ae81ff">1</span>
</code></pre></div><p>Update the version.txt to the number you think is appropriate</p>
<p>Then rebuild</p>
<p>Inspect the image size differences</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">docker images 
123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston   0.1.21        e199bbd29e43   <span style="color:#ae81ff">3</span> minutes ago    16.1MB
123456789012.dkr.ecr.us-west-2.amazonaws.com/golang_example-houston   0.1.20        20b885db4549   <span style="color:#ae81ff">12</span> minutes ago   376MB
</code></pre></div><p>Now scratch container only has the go binary in it</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ make ecr_scan_findings
aws ecr describe-image-scan-findings --repository-name golang_example-houston --image-id imageTag<span style="color:#f92672">=</span>0.1.21
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;imageScanStatus&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;FAILED&#34;</span>, 
        <span style="color:#e6db74">&#34;description&#34;</span>: <span style="color:#e6db74">&#34;UnsupportedImageError: The operating system and/or package manager are not supported.&#34;</span>
    <span style="color:#f92672">}</span>, 
    <span style="color:#e6db74">&#34;repositoryName&#34;</span>: <span style="color:#e6db74">&#34;golang_example-houston&#34;</span>, 
    <span style="color:#e6db74">&#34;registryId&#34;</span>: <span style="color:#e6db74">&#34;123456789012&#34;</span>, 
    <span style="color:#e6db74">&#34;imageId&#34;</span>: <span style="color:#f92672">{</span>
        <span style="color:#e6db74">&#34;imageTag&#34;</span>: <span style="color:#e6db74">&#34;0.1.21&#34;</span>, 
        <span style="color:#e6db74">&#34;imageDigest&#34;</span>: <span style="color:#e6db74">&#34;sha256:97169aa383bf476466e9af45079aed95e8bfdb09cbf94ca05a11ede20631c323&#34;</span>
    <span style="color:#f92672">}</span>, 
    <span style="color:#e6db74">&#34;imageScanFindings&#34;</span>: null
<span style="color:#f92672">}</span>
</code></pre></div><h2 id="aws-codepipeline">AWS CodePipeline</h2>
<p>Now that we have a CodePipeline setup thanks to terraform let&rsquo;s push our code there and watch the pipeline run</p>
<p>We need to give our Codepipeline Role access to the cluster</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make cluster_iam
eksctl create iamidentitymapping --cluster devsecops --arn arn:aws:iam::123456789012:role/devsecops-houston-codebuild   --username admin <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>--group system:masters
2021-09-18 20:33:43 <span style="color:#f92672">[</span>ℹ<span style="color:#f92672">]</span>  eksctl version 0.67.0
2021-09-18 20:33:43 <span style="color:#f92672">[</span>ℹ<span style="color:#f92672">]</span>  using region us-west-2
2021-09-18 20:33:43 <span style="color:#f92672">[</span>ℹ<span style="color:#f92672">]</span>  adding identity <span style="color:#e6db74">&#34;arn:aws:iam::123456789012:role/devsecops-houston-codebuild&#34;</span> to auth ConfigMap
</code></pre></div><p>We clone the repo from github but now let&rsquo;s push it to AWS CodeCommit</p>
<p>If you don&rsquo;t remember the name we can use the aws cli to find it for use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> aws codecommit   list-repositories
<span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;repositories&#34;</span>: <span style="color:#f92672">[</span>
        <span style="color:#f92672">{</span>
            <span style="color:#e6db74">&#34;repositoryName&#34;</span>: <span style="color:#e6db74">&#34;houston-devsecops-repo&#34;</span>, 
            <span style="color:#e6db74">&#34;repositoryId&#34;</span>: <span style="color:#e6db74">&#34;568b8724-36c5-44fe-9848-42e2db43a861&#34;</span>
        <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>Now we can push the repo to AWS Code commit by adding a new remote</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">git remote add aws https://git-codecommit.us-west-2.amazonaws.com/v1/repos/houston-devsecops-repo
git push aws 
</code></pre></div><p><a href="https://us-west-2.console.aws.amazon.com/codesuite/codepipeline/pipelines?region=us-west-2">Navigate to the CodePipeline console to build in progress</a></p>
<p><img src="/images/pipeline/code-pipeline-progress.png" alt=""></p>
<p>Once our deploymnet finishes we can test the cluster in AWS</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get svc clusterip-service
NAME                TYPE           CLUSTER-IP       EXTERNAL-IP                                                              PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>        AGE
clusterip-service   LoadBalancer   10.100.254.156   a9d40a7cc91b447e7a7830a6aa4a1b97-970438419.us-west-2.elb.amazonaws.com   80:30430/TCP   87m
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">~/environment/devsecopspipeline <span style="color:#f92672">(</span>main<span style="color:#f92672">)</span> $curl a9d40a7cc91b447e7a7830a6aa4a1b97-970438419.us-west-2.elb.amazonaws.com/
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Default Page&#34;</span><span style="color:#f92672">}</span>
~/environment/devsecopspipeline <span style="color:#f92672">(</span>main<span style="color:#f92672">)</span> $ curl a9d40a7cc91b447e7a7830a6aa4a1b97-970438419.us-west-2.elb.amazonaws.com/data
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;Database Connected&#34;</span><span style="color:#f92672">}</span>
~/environment/devsecopspipeline <span style="color:#f92672">(</span>main<span style="color:#f92672">)</span> $ curl a9d40a7cc91b447e7a7830a6aa4a1b97-970438419.us-west-2.elb.amazonaws.com/host
<span style="color:#f92672">{</span><span style="color:#e6db74">&#34;message&#34;</span>:<span style="color:#e6db74">&#34;NODE: ip-192-168-62-23.us-west-2.compute.internal, POD IP:192.168.51.0&#34;</span><span style="color:#f92672">}</span>
~/environment/devsecopspipeline <span style="color:#f92672">(</span>main<span style="color:#f92672">)</span> $ 
</code></pre></div>

<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/pipeline/intro_exercise/" title="Container Pipeline Exercise Overview"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/run/" title="Running Containers" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1632003396"></script>
    <script src="/js/perfect-scrollbar.min.js?1632003396"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1632003396"></script>
    <script src="/js/jquery.sticky.js?1632003396"></script>
    <script src="/js/featherlight.min.js?1632003396"></script>
    <script src="/js/highlight.pack.js?1632003396"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1632003396"></script>
    <script src="/js/learn.js?1632003396"></script>
    <script src="/js/hugo-learn.js?1632003396"></script>
    
        
            <script src="/mermaid/mermaid.js?1632003396"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

